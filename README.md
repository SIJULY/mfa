# sijuly-mfa - çº¯å‰ç«¯ MFA/TOTP åŠ¨æ€éªŒè¯ç ç”Ÿæˆå™¨

è¿™æ˜¯ä¸€ä¸ªè½»é‡çº§ã€çº¯å‰ç«¯å®ç°çš„ MFA (å¤šå› ç´ è®¤è¯) åŠ¨æ€éªŒè¯ç ç”Ÿæˆå™¨ã€‚å®ƒå…è®¸æ‚¨åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šå¿«é€Ÿéƒ¨ç½²ä¸€ä¸ªç½‘é¡µï¼Œç”¨äºç”ŸæˆåŸºäºæ—¶é—´çš„ä¸€æ¬¡æ€§å¯†ç  (TOTP)ï¼Œè€Œæ— éœ€ä¾èµ–ä»»ä½•ç¬¬ä¸‰æ–¹åº”ç”¨ã€‚

é¡¹ç›®å®Œå…¨å¼€æºï¼Œæ‚¨å¯ä»¥å°†å…¶éƒ¨ç½²åœ¨ä»»ä½•æœ‰ Docker ç¯å¢ƒçš„æœåŠ¡å™¨ä¸Šã€‚

*(å»ºè®®æ‚¨å°†é¡¹ç›®æˆªå›¾å‘½åä¸º `screenshot.png` å¹¶ä¸Šä¼ åˆ°ä»“åº“æ ¹ç›®å½•ï¼Œä»¥ä½¿æ­¤å›¾ç‰‡ç”Ÿæ•ˆ)*

## âœ¨ åŠŸèƒ½ç‰¹æ€§

- **çº¯å‰ç«¯å®ç°**ï¼šæ‰€æœ‰ TOTP è®¡ç®—éƒ½åœ¨ç”¨æˆ·çš„æµè§ˆå™¨ä¸­å®Œæˆï¼ŒæœåŠ¡å™¨é›¶è´Ÿæ‹…ï¼Œä¿éšœç§˜é’¥å®‰å…¨ã€‚
- **Docker åŒ–éƒ¨ç½²**ï¼šé€šè¿‡ Docker é•œåƒå°è£…ï¼Œå®ç°è·¨å¹³å°ã€ä¸€é”®å¼å¿«é€Ÿéƒ¨ç½²ã€‚
- **URL ç§˜é’¥æ³¨å…¥**ï¼šæ”¯æŒé€šè¿‡ URL å‚æ•° (`?key=...`) æˆ–å“ˆå¸Œ (`#...`) åŠ¨æ€ä¼ å…¥ç§˜é’¥ï¼Œæ–¹ä¾¿å°†ç‰¹å®šç§˜é’¥çš„é“¾æ¥ä¿å­˜ä¸ºä¹¦ç­¾ã€‚
- **ä¸€é”®å®‰è£…è„šæœ¬**ï¼šæä¾› `install.sh` è„šæœ¬ï¼Œå¯åœ¨æ”¯æŒ Docker å’Œ Caddy çš„æœåŠ¡å™¨ä¸Šä¸€é”®å®Œæˆéƒ¨ç½²ã€é…ç½®åå‘ä»£ç†åŠ HTTPSã€‚
- **å¤šç§è®¿é—®æ–¹å¼**ï¼šå®‰è£…è„šæœ¬æ”¯æŒ**åŸŸå (è‡ªåŠ¨HTTPS)** å’Œ **å…¬ç½‘IP (HTTP)** ä¸¤ç§éƒ¨ç½²æ¨¡å¼ã€‚
- **è½»æ¾å¸è½½**ï¼šä¸€é”®è„šæœ¬åŒæ ·æä¾›å®Œæ•´çš„å¸è½½åŠŸèƒ½ï¼Œè‡ªåŠ¨æ¸…ç†å®¹å™¨ã€é•œåƒåŠç›¸å…³é…ç½®ã€‚

## ğŸš€ å¿«é€Ÿå¼€å§‹ï¼šä¸€é”®éƒ¨ç½²æ•™ç¨‹

æœ¬æ•™ç¨‹é€‚ç”¨äºä¸€å°å…¨æ–°çš„ã€å·²å®‰è£…å¥½ `git` å’Œ `docker` çš„ VPS (æ¨è Debian/Ubuntu ç³»ç»Ÿ)ã€‚

### å¿…é€‰ï¼šå‰ç½®ä¾èµ–å®‰è£…

åœ¨è¿è¡Œä¸€é”®è„šæœ¬ä¹‹å‰ï¼Œè¯·ç¡®ä¿æ‚¨çš„æœåŠ¡å™¨å·²å®‰è£… `git` å’Œ `docker`ã€‚

```bash
# æ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨
sudo apt update

# å®‰è£… git
sudo apt install -y git

# å®‰è£… docker
# (å¦‚æœå·²å®‰è£…è¯·è·³è¿‡)
curl -fsSL https://get.docker.com -o get-docker.sh
sudo sh get-docker.sh

## ğŸŒ å¯é€‰ï¼šå®‰è£… Caddy (å¦‚æœéœ€è¦ä½¿ç”¨åŸŸå)
å¦‚æœæ‚¨å¸Œæœ›é€šè¿‡åŸŸåå¹¶è‡ªåŠ¨å¯ç”¨ HTTPS è®¿é—®æ‚¨çš„ MFA ç½‘é¡µï¼ˆè¿™æ˜¯æ¨èçš„æ–¹å¼ï¼‰ï¼Œæ‚¨éœ€è¦å®‰è£… Caddy Web æœåŠ¡å™¨ã€‚
å¦‚æœæ‚¨é€‰æ‹©ç¨åä½¿ç”¨ IP åœ°å€è®¿é—®ï¼Œåˆ™å¯ä»¥è·³è¿‡æ­¤æ­¥éª¤ã€‚

```bash
# 1. å®‰è£… Caddy æ‰€éœ€çš„ä¾èµ–
sudo apt update && sudo apt install -y debian-keyring debian-archive-keyring apt-transport-https
# 2. å¯¼å…¥ Caddy çš„ GPG å¯†é’¥ä»¥éªŒè¯è½¯ä»¶åŒ…
curl -1sLf '[https://dl.cloudsmith.io/public/caddy/stable/gpg.key](https://dl.cloudsmith.io/public/caddy/stable/gpg.key)' | sudo gpg --dearmor -o /usr/share/keyrings/caddy-stable-archive-keyring.gpg
# 3. æ·»åŠ  Caddy çš„å®˜æ–¹è½¯ä»¶æº
curl -1sLf '[https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt](https://dl.cloudsmith.io/public/caddy/stable/debian.deb.txt)' | sudo tee /etc/apt/sources.list.d/caddy-stable.list
# 4. æ›´æ–°è½¯ä»¶åŒ…åˆ—è¡¨å¹¶å®‰è£… Caddy
sudo apt update && sudo apt install caddy

##å®‰è£…å®Œæˆåï¼ŒCaddy å°†ä¼šè‡ªåŠ¨ä½œä¸ºç³»ç»ŸæœåŠ¡åœ¨åå°è¿è¡Œã€‚
